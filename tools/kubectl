#!/usr/bin/env variant
# vi: ft=yaml

bindParamsFromEnv: true

parameters:
  - name: TOOLBOX_K8S_NAMESPACE
    default: default
  - name: KUBECONFIG
    default: .secrets/kubeconfig

tasks:
  core:
    import: /toolbox/variant-lib/utils.yaml

  apply:
    tasks:
      dir:
        autoenv: true
        parameters:
          - name: dir
            default: kubernetes
        steps:
          - task: core.exec
            arguments:
              title: Apply k8s manifests from {{ .dir }} directory recursively
              cmd: |
                kubectl apply -n {{ .TOOLBOX_K8S_NAMESPACE }} -f {{ .dir }} -R

  k9s:
    steps:
      - task: core.exec
        arguments:
          title: Execute k9s
          cmd: |
            k9s

