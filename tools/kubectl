#!/usr/bin/env variant
# vi: ft=yaml

bindParamsFromEnv: true

parameters:
  - name: TOOLBOX_K8S_NAMESPACE
    default: default

tasks:
  core:
    import: toolbox/.toolbox/deps/toolbox/variant-lib/utils.yaml
  apply:
    tasks:
      dir:
        parameters:
          - name: dir
            default: kubernetes
        steps:
          - task: core.exec
            arguments:
              title: Apply k8s manifests from {{ .dir }} directory recursively
              cmd: |
                echo "TOOLBOX_K8S_NAMESPACE: {{ .TOOLBOX_K8S_NAMESPACE }}"
                kubectl apply -n {{ .TOOLBOX_K8S_NAMESPACE }} -f {{ .dir }} -R
